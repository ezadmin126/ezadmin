<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.ezadmin.domain.mapper.ext.BlogExtendMapper">
  <resultMap id="BaseResultMap" type="top.ezadmin.blog.vo.BlogVO">
    <result column="BLOG_ID" jdbcType="INTEGER" property="blogId" />
    <result column="ADD_TIME" jdbcType="TIMESTAMP" property="addTime" />
    <result column="VIEW_TIMES" jdbcType="INTEGER" property="viewTimes" />
    <result column="STATUS" jdbcType="INTEGER" property="status" />
    <result column="CATEGORY_ID" jdbcType="INTEGER" property="categoryId" />
    <result column="LIKE_TIMES" jdbcType="INTEGER" property="likeTimes" />
    <result column="BLOG_SUB_TITLE" jdbcType="VARCHAR" property="blogSubTitle" />
    <result column="CATEGORY_NAME" jdbcType="VARCHAR" property="categoryName"/>
    <result column="BLOG_TITLE" jdbcType="VARCHAR" property="blogTitle" />
    <result column="BLOG_CONTENT" jdbcType="CLOB" property="blogContent" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Mar 21 20:51:26 CST 2022.
    -->
    BLOG_ID, ADD_TIME, VIEW_TIMES, STATUS, CATEGORY_ID, LIKE_TIMES, BLOG_SUB_TITLE,BLOG_TITLE
  </sql>
  <select id="search"  resultMap="BaseResultMap">
    select
    BLOG_ID, a.ADD_TIME, VIEW_TIMES, a.STATUS, a.CATEGORY_ID, LIKE_TIMES, BLOG_SUB_TITLE,BLOG_TITLE,
           b.CATEGORY_NAME
    from T_BLOG a left join T_BLOG_CATEGORY b on a.CATEGORY_ID=b.CATEGORY_ID
where a.STATUS=1
 <if test="categoryId !=null and categoryId > 0">
   and a.CATEGORY_ID=#{categoryId}
 </if>
    <if test="keyword !=null and keyword !=''">
      and (
      upper(a.BLOG_TITLE) like concat('%',#{keyword},'%')
    OR  upper(a.BLOG_SUB_TITLE) like concat('%',#{keyword},'%')
      )
    </if>
order by BLOG_ID desc
  </select>

  <select id="hottest"  resultMap="BaseResultMap">
    select
    BLOG_ID, a.ADD_TIME, VIEW_TIMES, a.STATUS, a.CATEGORY_ID, LIKE_TIMES, BLOG_SUB_TITLE,BLOG_TITLE,
    b.CATEGORY_NAME
    from T_BLOG a left join T_BLOG_CATEGORY b on a.CATEGORY_ID=b.CATEGORY_ID
    where a.STATUS=1
    order by VIEW_TIMES desc
   limit 3
  </select>
  <select id="newtest"  resultMap="BaseResultMap">
    select
    BLOG_ID, a.ADD_TIME, VIEW_TIMES, a.STATUS, a.CATEGORY_ID, LIKE_TIMES, BLOG_SUB_TITLE,BLOG_TITLE,
    b.CATEGORY_NAME
    from T_BLOG a left join T_BLOG_CATEGORY b on a.CATEGORY_ID=b.CATEGORY_ID
    where a.STATUS=1

    order by BLOG_ID desc
      limit 3
  </select>



</mapper>